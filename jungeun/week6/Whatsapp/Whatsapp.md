# 영상 보기 전의 내 설계

일단 굉장히 어려웠습니다!

유저 서비스, 채팅 서비스로 서버를 분리하고 사진이나 미디어는 S3에 저장하고, 채팅 내역은 몽고디비나 타임 시리즈로 관리, 그리고 빠른 응답을 위해 레디스로 캐싱을 하면 좋겠다 정도에서 사고가 멈췄다. 그래서 고민하다 영상과 가상 면접 사례 책을 봤습니다! 

# 문제 해결 접근 방식의 차이


## 1. 문제 발생 가능성 분석
### 내 접근
- 단순 기능 구현에만 초점
- 장애나 확장성 문제 고려 부족

### 개선점
- **잠재적 문제점 예측**
  - 메시지 유실 가능성
  - 대규모 트래픽 처리
  - 네트워크 지연/단절
  - 서버 장애 상황
  - 데이터 정합성 문제

## 2. 확장성 고려
### 내 접근
- 서버 분리 정도만 고려
- 구체적인 확장 전략 부재

### 개선점
- **단계적 확장 전략 수립**
  - 초기: 단일 서버로 시작
  - 성장: 수평적 확장 계획
  - 대규모: 분산 시스템 설계

# 아키텍처 설계의 차이

## 1. 통신 프로토콜
### 내 설계
- 프로토콜 선택에 대한 고려 없음

### 개선점
- **WebSocket 선택 및 이유**
  - 양방향 실시간 통신 필요
  - 연결 유지로 오버헤드 감소
  - 낮은 지연 시간 보장

## 2. 데이터 저장소 선택
### 내 설계
- MongoDB와 Redis만 고려
- 데이터 특성에 따른 구분 없음

### 개선점
- **데이터 특성별 저장소 분리**
  - 메시지 메타데이터: DynamoDB
  - 미디어 파일: S3
  - 실시간 상태: Redis
  - 각 저장소의 장단점과 선택 이유 이해 필요

## 3. 메시지 전달 보장
### 내 설계
- 단순 메시지 전송만 고려
- 전달 보장 메커니즘 부재

### 개선점
- **신뢰성 있는 전달 시스템**
  - Inbox 테이블 도입
  - ACK 메커니즘 구현
  - 재시도 로직
  - 오프라인 메시지 동기화

## 4. 분산 시스템 설계
### 내 설계
- 단순 서버 분리만 고려
- 서버 간 통신 방식 미고려

### 개선점
- **효율적인 분산 처리**
  - Layer 4 로드밸런서 사용
  - Redis Pub/Sub 메시징
  - 서버 간 메시지 라우팅
  - Hot-spot 방지 전략

## 5. 장애 대응
### 내 설계
- 장애 상황 고려 부족
- 복구 전략 부재

### 개선점
- **장애 허용 시스템**
  - 서버 다중화
  - 데이터 복제
  - 장애 감지 및 복구
  - 메시지 재전송 메커니즘

# 배운 점
1. 문제를 더 체계적으로 분석하고 정량적인 목표를 설정해야 함
2. 발생 가능한 문제들을 미리 예측하고 대응 방안을 마련해야 함
3. 기술 선택 시 각 기술의 특성과 선택 이유를 명확히 해야 함
4. 대규모 시스템의 경우 단계적 확장 전략이 중요함
5. 장애 상황을 고려한 설계가 필수적임